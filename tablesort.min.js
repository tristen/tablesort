// http://tristen.ca/tablesort/demo/ Version 4.1.0. Copyright 2016 tristen.
!function(){function t(e,n){if(!(this instanceof t))return new t(e,n);if(!e||"TABLE"!==e.tagName)throw new Error("Element must be a table");this.init(e,n||{})}var e=[],n=function(t){var e;return window.CustomEvent&&"function"==typeof window.CustomEvent?e=new CustomEvent(t):(e=document.createEvent("CustomEvent"),e.initCustomEvent(t,!1,!1,void 0)),e},s=function(t){return t.getAttribute("data-sort")||t.textContent||t.innerText||""},r=function(t,e){return t=t.toLowerCase(),e=e.toLowerCase(),t===e?0:t<e?1:-1},o=function(t,e){return function(n,s){var r=t(n.td,s.td);return 0===r?e?s.index-n.index:n.index-s.index:r}};t.extend=function(t,n,s){if("function"!=typeof n||"function"!=typeof s)throw new Error("Pattern and sort must be a function");e.push({name:t,pattern:n,sort:s})},t.prototype={init:function(t,e){var n,s,r,o,i=this;if(i.table=t,i.thead=!1,i.options=e,t.rows&&t.rows.length>0)if(t.tHead&&t.tHead.rows.length>0){for(r=0;r<t.tHead.rows.length;r++)if(t.tHead.rows[r].classList.contains("sort-row")){n=t.tHead.rows[r];break}n||(n=t.tHead.rows[t.tHead.rows.length-1]),i.thead=!0}else n=t.rows[0];if(n){var a=function(){i.current&&i.current!==this&&i.current.removeAttribute("aria-sort"),i.current=this,i.sortTable(this)};for(r=0;r<n.cells.length;r++)o=n.cells[r],o.setAttribute("role","columnheader"),o.classList.contains("no-sort")||(o.tabindex=0,o.addEventListener("click",a,!1),o.classList.contains("sort-default")&&(s=o));s&&(i.current=s,i.sortTable(s))}},sortTable:function(t,i){var a,d=this,c=t.cellIndex,l=r,u="",f=[],h=d.thead?0:1,g=t.getAttribute("data-sort-method"),b=t.getAttribute("aria-sort");if(d.table.dispatchEvent(n("beforeSort")),i?a=t.classList.contains("ascending")?"ascending":"descending":(a=t.classList.contains("ascending")?"descending":t.classList.contains("descending")?"ascending":"ascending"===b?"descending":"descending"===b?"ascending":d.options.descending?"ascending":"descending",t.setAttribute("aria-sort",a)),!(d.table.rows.length<2)){if(!g){for(;f.length<3&&h<d.table.tBodies[0].rows.length;)u=s(d.table.tBodies[0].rows[h].cells[c]),u=u.trim(),u.length>0&&f.push(u),h++;if(!f)return}for(h=0;h<e.length;h++)if(u=e[h],g){if(u.name===g){l=u.sort;break}}else if(f.every(u.pattern)){l=u.sort;break}for(d.col=c,h=0;h<d.table.tBodies.length;h++){var w,v=[],m={},p=0,E=0;if(!(d.table.tBodies[h].rows.length<2)){for(w=0;w<d.table.tBodies[h].rows.length;w++)u=d.table.tBodies[h].rows[w],u.classList.contains("no-sort")?m[p]=u:v.push({tr:u,td:s(u.cells[d.col]),index:p}),p++;for("descending"===a?(v.sort(o(l,!0)),v.reverse()):v.sort(o(l,!1)),w=0;w<p;w++)m[w]?(u=m[w],E++):u=v[w-E].tr,d.table.tBodies[h].appendChild(u)}}d.table.dispatchEvent(n("afterSort"))}},refresh:function(){void 0!==this.current&&this.sortTable(this.current,!0)}},"undefined"!=typeof module&&module.exports?module.exports=t:window.Tablesort=t}();
